---
name: zhr-execute
description: |
  âš ï¸ **å·²å¼ƒç”¨** - è¯·ä½¿ç”¨ `/zhr-run` æ›¿ä»£ï¼ˆv5.0 åˆå¹¶ç‰ˆï¼‰

  é›¶å¹»è§‰è°ƒç ” - æ‰§è¡Œé˜¶æ®µï¼ˆç‹¬ç«‹ä¼šè¯æ¶æ„ï¼‰ã€‚
  ä»…æ‰§è¡Œ Phase 3-5ï¼šæ·±åº¦è°ƒç ” + éªŒè¯ + åˆæˆã€‚
  å¿…é¡»ä½¿ç”¨ Task å·¥å…·å¯åŠ¨ subagentã€‚
  æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼šä» state.json è¯»å–è¿›åº¦ç»§ç»­æ‰§è¡Œã€‚

  > æ­¤ skill å·²è¢« `/zhr-run` åˆå¹¶ç‰ˆæ›¿ä»£ã€‚
  > `/zhr-run` åˆå¹¶äº† execute + verifyï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚
user-invocable: true
allowed-tools:
  - Read
  - Write
  - Edit
  - Bash
  - Glob
  - Grep
  - WebSearch
  - WebFetch
  - Task
  - AskUserQuestion
  - mcp__claude-in-chrome__*
hooks:
  PreToolUse:
    - matcher: "Task"
      hooks:
        - type: command
          command: "echo 'ğŸš€ Task å·¥å…·è°ƒç”¨: ç¡®ä¿ subagent éµå¾ª [äº‹å®]/[æ¨ç†]/[æœªéªŒè¯] æ ‡æ³¨è§„åˆ™'"
  SubagentStart:
    - hooks:
        - type: command
          command: "echo 'ğŸš¨ SUBAGENT å¯åŠ¨: ä½ å¿…é¡»éµå¾ªé›¶å¹»è§‰è§„åˆ™ï¼æ¯æ¡ä¿¡æ¯æ ‡æ³¨ [äº‹å®]/[æ¨ç†]/[æœªéªŒè¯] + å¯ä¿¡åº¦ ğŸŸ¢A/ğŸŸ¢B/ğŸŸ¡C/ğŸŸ D/ğŸ”´F + æ¥æº ğŸ“Œ/ğŸ”'"
---

# é›¶å¹»è§‰è°ƒç ” - æ‰§è¡Œé˜¶æ®µ (Phase 3-5)

> **æ¶æ„**: ç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£ï¼ˆç¬¦åˆåŸå§‹ Ralph è®¾è®¡ï¼‰
> **çŠ¶æ€ä¼ é€’**: é€šè¿‡ `.research/state.json` æ–‡ä»¶ç³»ç»Ÿ
> **æ–­ç‚¹ç»­ä¼ **: æ”¯æŒä»ä¸Šæ¬¡ä¸­æ–­å¤„ç»§ç»­æ‰§è¡Œ

ä½ æ˜¯è°ƒç ”æ‰§è¡Œå‘˜ï¼Œè´Ÿè´£**ä»…æ‰§è¡Œæ·±åº¦è°ƒç ”é˜¶æ®µ**ã€‚

---

## ğŸš¨ å¯åŠ¨æ—¶çŠ¶æ€æ£€æŸ¥ï¼ˆå¼ºåˆ¶ï¼ï¼‰

**åœ¨æ‰§è¡Œä»»ä½•æ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆæ£€æŸ¥çŠ¶æ€æ–‡ä»¶ï¼**

```python
# 1. è¯»å– state.json
state = read_json(".research/state.json")

# 2. å‰ç½®æ¡ä»¶æ£€æŸ¥
if state.phase_status.plan != "completed":
    ERROR("è®¡åˆ’é˜¶æ®µæœªå®Œæˆï¼è¯·å…ˆæ‰§è¡Œ /zhr-plan")
    EXIT

if not state.user_approvals.prd_approval.approved:
    ERROR("PRD æœªè·å¾—ç”¨æˆ·å®¡æ‰¹ï¼è¯·å…ˆå®Œæˆ /zhr-plan çš„å®¡æ‰¹æµç¨‹")
    EXIT

# 3. æ–­ç‚¹ç»­ä¼ æ£€æŸ¥
if state.phase_status.execute == "in_progress":
    RESUME_FROM(state.execute.current_step)
elif state.phase_status.execute == "completed":
    INFO("æ‰§è¡Œé˜¶æ®µå·²å®Œæˆï¼Œè·³è¿‡")
    EXIT
```

**æ£€æŸ¥å¤±è´¥æ—¶çš„è¾“å‡ºï¼š**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ERROR: å‰ç½®æ¡ä»¶æ£€æŸ¥å¤±è´¥
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ æ£€æŸ¥é¡¹: {æ£€æŸ¥é¡¹åç§°}
âŒ å½“å‰çŠ¶æ€: {å½“å‰å€¼}
âŒ æœŸæœ›çŠ¶æ€: {æœŸæœ›å€¼}

è¯·å…ˆå®Œæˆå‰ç½®æ­¥éª¤ï¼š
1. æ‰§è¡Œ /zhr-plan åˆ›å»ºè°ƒç ”è®¡åˆ’
2. ç¡®ä¿ PRD è·å¾—ç”¨æˆ·å®¡æ‰¹

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸš¨ BLOCKING REQUIREMENT: å¿…é¡»ä½¿ç”¨ Task å·¥å…·ï¼

**â›” ç¦æ­¢ç›´æ¥æ‰§è¡Œè°ƒç ”ï¼å¿…é¡»é€šè¿‡ Task å·¥å…·å¯åŠ¨ subagentï¼**

```python
# âœ… æ­£ç¡®åšæ³•
Task(
    subagent_type="general-purpose",
    prompt="è°ƒç ” [ä¸»é¢˜]...",
    run_in_background=True,  # å¿«é€Ÿæ¨¡å¼
    description="è°ƒç ” [ä¸»é¢˜]"
)

# âŒ é”™è¯¯åšæ³•
WebSearch("...")  # ç¦æ­¢ç›´æ¥æœç´¢ï¼
```

---

## ğŸ¯ ä½ çš„å”¯ä¸€ä»»åŠ¡

æ‰§è¡Œ Phase 3-5ï¼Œå®Œæˆæ·±åº¦è°ƒç ”ã€‚
**å®Œæˆåè¾“å‡º `PHASE_COMPLETE: execute` å¹¶ç»“æŸä¼šè¯ã€‚**
**ä¸è¦æ‰§è¡Œ Phase 6+ï¼Œç­‰å¾…å¤–éƒ¨è„šæœ¬æˆ–ç”¨æˆ·è°ƒç”¨ /zhr-verifyã€‚**

---

## Phase 3: æ·±åº¦è°ƒç ”ï¼ˆæ ¸å¿ƒï¼‰

### 3.1 è¯»å–è®¡åˆ’
```
1. è¯»å– .research/state.json
2. è¯»å– .research/task_plan.md
3. è¯»å– .research/memory/priority.md
4. ç¡®è®¤éœ€è¦è°ƒç ”çš„ä¸»é¢˜åˆ—è¡¨
```

### 3.2 å¯åŠ¨ Subagents

**âš ï¸ MUST ä½¿ç”¨ Task å·¥å…·ï¼**

å¯¹äºæ¯ä¸ªä¸»é¢˜ï¼Œå¯åŠ¨ä¸€ä¸ª Taskï¼š
```
Task å·¥å…·å‚æ•°ï¼š
- subagent_type: "general-purpose"
- description: "è°ƒç ” {ä¸»é¢˜åç§°}"
- run_in_background: true (å¿«é€Ÿæ¨¡å¼) æˆ– false (Chromeæ¨¡å¼)
- prompt: [ä¸‹æ–¹çš„ Subagent æŒ‡ä»¤]
```

### 3.3 Subagent æŒ‡ä»¤æ¨¡æ¿

```
ä½ æ˜¯è°ƒç ” [{ä¸»é¢˜åç§°}] çš„ç ”ç©¶å‘˜ã€‚

## ä»»åŠ¡
è°ƒç ”å…³äº [{ä¸»é¢˜åç§°}] çš„ä»¥ä¸‹ä¿¡æ¯ï¼š
[ä¿¡æ¯ç±»å‹åˆ—è¡¨]

## ç”¨æˆ·æŒ‡å®šæ¥æºï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰
ğŸ“Œ [æ¥æº1]: URL
ğŸ“Œ [æ¥æº2]: URL

## è¾“å‡ºè¦æ±‚

### ä¿¡æ¯æ ‡æ³¨ï¼ˆå¼ºåˆ¶ï¼‰
- **[äº‹å®]** æ ¼å¼ï¼š`[äº‹å®] å†…å®¹ (æ¥æº: URL) [å¯ä¿¡åº¦: ç­‰çº§] [è·å–æ—¶é—´: YYYY-MM-DD]`
- **[æ¨ç†]** æ ¼å¼ï¼š`[æ¨ç†] å†…å®¹ (ä¾æ®: äº‹å®1, äº‹å®2) [å¯ä¿¡åº¦: ğŸŸ¡ C]`
- **[æœªéªŒè¯]** æ ¼å¼ï¼š`[æœªéªŒè¯] å†…å®¹ (åŸå› : ...) [å¯ä¿¡åº¦: ğŸ”´ F]`

### å¯ä¿¡åº¦è¯„åˆ†
ğŸŸ¢ A: å®˜æ–¹ä¸€æ‰‹ | ğŸŸ¢ B: å®˜æ–¹äºŒæ‰‹ | ğŸŸ¡ C: åŠå®˜æ–¹ | ğŸŸ  D: ç¤¾åŒº | ğŸ”´ F: æœªéªŒè¯

### æ¥æºæ ‡æ³¨
ğŸ“Œ ç”¨æˆ·æŒ‡å®š | ğŸ” AIè‡ªä¸»å‘ç°

### è¯šå®åŸåˆ™
æ— æ³•è·å–æ—¶ç›´æ¥è¯´æ˜ï¼Œä¸çŒœæµ‹ï¼š
âŒ "æ ¹æ®è§„å¾‹æ¨æµ‹..."
âœ… "[æœªéªŒè¯] XXX (åŸå› : æ— æ³•è®¿é—®) [å¯ä¿¡åº¦: ğŸ”´ F]"

## è¾“å‡ºè¡¨æ ¼
| ä¿¡æ¯ | å†…å®¹ | æ¥æº | ç±»å‹ | å¯ä¿¡åº¦ | æ—¶é—´ |
|------|------|------|------|--------|------|

## å‘ç°çš„æ–°éœ€æ±‚
ï¼ˆå¦‚æœ‰ï¼Œåˆ—åœ¨æœ€åï¼‰
```

### 3.4 æ›´æ–°çŠ¶æ€
æ¯ä¸ª subagent å®Œæˆåï¼š
```json
{
  "topics": [
    {
      "id": "topic_1",
      "status": "completed",  // æ›´æ–°çŠ¶æ€
      "completed_at": "YYYY-MM-DD HH:MM:SS"
    }
  ]
}
```

---

## Phase 4: ä¸‰è§’éªŒè¯

### 4.1 æ”¶é›†ç»“æœ
```
è¯»å–æ‰€æœ‰ .research/findings/{topic_id}.md æ–‡ä»¶
```

### 4.2 CiteGuard éªŒè¯
å¯¹æ¯ä¸ª [äº‹å®] æ£€æŸ¥ï¼š
- [ ] æ˜¯å¦æœ‰æ¥æº URLï¼Ÿ
- [ ] URL æ˜¯å¦å¯è®¿é—®ï¼Ÿï¼ˆå¯é€‰éªŒè¯ï¼‰
- [ ] å†…å®¹æ˜¯å¦ä¸æ¥æºä¸€è‡´ï¼Ÿ

æ ‡è®°éªŒè¯ç»“æœï¼š
- âœ… å·²éªŒè¯
- âš ï¸ æ— æ³•éªŒè¯
- âŒ éªŒè¯å¤±è´¥

### 4.3 äº¤å‰éªŒè¯
æ£€æµ‹åŒä¸€ä¿¡æ¯å¤šæ¥æºçš„æƒ…å†µï¼š
- ä¸€è‡´ â†’ åˆå¹¶ï¼Œæ ‡è®° [å¤šæºéªŒè¯]
- ä¸ä¸€è‡´ â†’ æ ‡è®° [å†²çª]

### 4.4 æ›´æ–°å·¥ä½œè®°å¿†
å†™å…¥ `.research/memory/working.md`ï¼š
```markdown
# å·¥ä½œè®°å¿†ï¼ˆæœ¬æ¬¡è°ƒç ”å…³é”®å‘ç°ï¼‰

## å·²éªŒè¯çš„äº‹å®
- âœ… äº‹å®1
- âœ… äº‹å®2

## å­˜åœ¨å†²çªçš„ä¿¡æ¯
- [å†²çª] ä¿¡æ¯X
  - æ¥æºA: ...
  - æ¥æºB: ...

## å¾…ç”¨æˆ·ç¡®è®¤
- ä¿¡æ¯Yï¼šåŸå› 
```

---

## Phase 5: åˆæˆæŠ¥å‘Š

### 5.1 ç”ŸæˆæŠ¥å‘Š
åˆ›å»º `.research/report.md`ï¼š
```markdown
# è°ƒç ”æŠ¥å‘Š

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦
- **è°ƒç ”ä¸»é¢˜**ï¼š[N] ä¸ª
- **å®ŒæˆçŠ¶æ€**ï¼š[X]/[Y] å®Œæˆ
- **éªŒæ”¶æ ‡å‡†**ï¼š[X]/[Y] æ»¡è¶³

### å¯ä¿¡åº¦ç»Ÿè®¡
| ç­‰çº§ | æ•°é‡ | å æ¯” |
|------|------|------|
| ğŸŸ¢ A | X | XX% |
| ğŸŸ¢ B | X | XX% |
| ğŸŸ¡ C | X | XX% |
| ğŸŸ  D | X | XX% |
| ğŸ”´ F | X | XX% |

## ğŸ“š é€ä¸»é¢˜æ±‡æ€»
[æ¯ä¸ªä¸»é¢˜çš„è¯¦ç»†ä¿¡æ¯è¡¨]

## âš ï¸ å†²çªæ£€æµ‹
[ä¿¡æ¯å†²çªå’Œæ—¶é—´å†²çª]

## â“ å¾…ç¡®è®¤é¡¹
[éœ€ç”¨æˆ·éªŒè¯çš„ä¿¡æ¯]

## âœ… éªŒæ”¶æ£€æŸ¥
| æ ‡å‡† | çŠ¶æ€ |
|------|------|
| æ ‡å‡†1 | âœ…/âš ï¸/âŒ |
```

### 5.2 æ›´æ–°çŠ¶æ€ (v2.0 æ ¼å¼)

**æ›´æ–° state.jsonï¼š**
```json
{
  "current_phase": "execute",
  "phase_status": {
    "plan": "completed",
    "execute": "completed",
    "verify": "pending"
  },
  "execute": {
    "started_at": "YYYY-MM-DD HH:MM:SS",
    "completed_at": "YYYY-MM-DD HH:MM:SS",
    "current_step": "phase_5_complete",
    "phase_3_complete": true,
    "phase_3_5_complete": true,
    "phase_4_complete": true,
    "phase_5_complete": true,
    "findings_count": 5
  },
  "session_history": [
    {"session_id": "plan-001", "phase": "plan", "...": "..."},
    {"session_id": "execute-001", "phase": "execute", "started_at": "...", "completed_at": "..."}
  ],
  "last_updated": "YYYY-MM-DD HH:MM:SS"
}
```

---

## âœ… å®Œæˆæ£€æŸ¥

æ‰§è¡Œé˜¶æ®µå®Œæˆåï¼Œå¿…é¡»ç¡®è®¤ï¼š
- [ ] çŠ¶æ€æ£€æŸ¥å·²é€šè¿‡ï¼ˆplan completed, PRD approvedï¼‰
- [ ] æ‰€æœ‰ä¸»é¢˜éƒ½ä½¿ç”¨ Task å·¥å…·å¯åŠ¨äº† subagent
- [ ] æ‰€æœ‰ `.research/findings/{topic}.md` å·²åˆ›å»º
- [ ] Phase 3.5 Adder Agent å®Œæ•´æ€§å®¡è®¡å·²æ‰§è¡Œ
- [ ] `.research/memory/working.md` å·²æ›´æ–°
- [ ] `.research/report.md` å·²ç”Ÿæˆ
- [ ] `state.json.phase_status.execute` = "completed"

---

## ğŸ“¢ å®Œæˆåè¾“å‡ºï¼ˆå¼ºåˆ¶æ ¼å¼ï¼‰

**å¿…é¡»è¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œä¾›å¤–éƒ¨è„šæœ¬è§£æï¼š**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE_COMPLETE: execute
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… æ‰§è¡Œé˜¶æ®µå®Œæˆï¼

å·²å®Œæˆï¼š
- Phase 3: æ·±åº¦è°ƒç ”ï¼ˆ{N} ä¸ª subagentï¼‰
- Phase 3.5: Adder Agent å®Œæ•´æ€§å®¡è®¡
- Phase 4: ä¸‰è§’éªŒè¯ + CiteGuard URL éªŒè¯
- Phase 5: åˆæˆæŠ¥å‘Š

æŠ¥å‘Šä½ç½®ï¼š.research/report.md

çŠ¶æ€æ–‡ä»¶æ£€æŸ¥ç‚¹ï¼š
- phase_status.execute: completed
- execute.phase_5_complete: true
- execute.findings_count: {N}

æ¥æºå®¡è®¡ï¼š
- ğŸ“Œ ç”¨æˆ·æŒ‡å®šæ¥æº: {X} ä¸ª
- ğŸ” AI è‡ªä¸»å‘ç°: {Y} ä¸ª
- âœ… URL å·²éªŒè¯: {Z} ä¸ª

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ä¸‹ä¸€æ­¥ï¼š
  - æ‰‹åŠ¨æ‰§è¡Œ: /zhr-verify
  - æˆ–ä½¿ç”¨å¤–éƒ¨è„šæœ¬: ralph-zhr.bat (Windows) / ralph-zhr.sh (Linux/Mac)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ›‘ ä¼šè¯ç»“æŸè§„åˆ™

**â›” è¾“å‡º `PHASE_COMPLETE: execute` åï¼Œæœ¬ä¼šè¯å¿…é¡»ç»“æŸï¼**

- **ç¦æ­¢**ç»§ç»­æ‰§è¡Œ Phase 6+
- **ç¦æ­¢**åœ¨åŒä¸€ä¼šè¯ä¸­è°ƒç”¨ /zhr-verify
- **ç­‰å¾…**å¤–éƒ¨è„šæœ¬æˆ–ç”¨æˆ·åœ¨**æ–°ä¼šè¯**ä¸­è°ƒç”¨ /zhr-verify

**åŸå› **ï¼šä¿æŒç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£ï¼Œé¿å…ä¸Šä¸‹æ–‡ç´¯ç§¯ã€‚

---

## ğŸ”„ æ–­ç‚¹ç»­ä¼ è¯´æ˜

**å¦‚æœä¼šè¯ä¸­é€”ä¸­æ–­ï¼Œä¸‹æ¬¡è°ƒç”¨ /zhr-execute æ—¶ï¼š**

1. è¯»å– `state.json.execute.current_step` ç¡®å®šä¸­æ–­ä½ç½®
2. æ£€æŸ¥ `state.json.execute.subagent_status` ç¡®å®šå„ä¸»é¢˜çŠ¶æ€
3. è·³è¿‡å·²å®Œæˆçš„ä¸»é¢˜ï¼Œç»§ç»­æ‰§è¡Œæœªå®Œæˆçš„éƒ¨åˆ†
4. å®Œæˆåæ­£å¸¸è¾“å‡º `PHASE_COMPLETE: execute`

**æ–­ç‚¹ç»­ä¼ çŠ¶æ€ç¤ºä¾‹ï¼š**
```json
{
  "execute": {
    "current_step": "phase_4",
    "subagent_status": {
      "topic_1": "completed",
      "topic_2": "completed",
      "topic_3": "in_progress"
    },
    "phase_3_complete": true,
    "phase_3_5_complete": true,
    "phase_4_complete": false,
    "phase_5_complete": false
  }
}
```
